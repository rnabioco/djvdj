<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculate the frequency of each cell label present in the provided meta.data
column. This is useful for comparing the proportion of cells belonging to
different samples, cell types, clonotypes, isotypes, etc."><title>Calculate frequency of cell groups present in object — calc_frequency • djvdj</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.5/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.5/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Calculate frequency of cell groups present in object — calc_frequency"><meta property="og:description" content="Calculate the frequency of each cell label present in the provided meta.data
column. This is useful for comparing the proportion of cells belonging to
different samples, cell types, clonotypes, isotypes, etc."><meta property="og:image" content="https://rnabioco.github.io/djvdj/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="rnabioco.github.io" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">djvdj</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Data import and manipulation</h6>
    <a class="dropdown-item" href="../articles/import.html">Data Import</a>
    <a class="dropdown-item" href="../articles/mutate.html">Data Manipulation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>VDJ analysis</h6>
    <a class="dropdown-item" href="../articles/frequency.html">Clonotype Frequencies</a>
    <a class="dropdown-item" href="../articles/diversity.html">Repertoire Diversity</a>
    <a class="dropdown-item" href="../articles/similarity.html">Repertoire Similarity</a>
    <a class="dropdown-item" href="../articles/gene-usage.html">Gene Usage</a>
    <a class="dropdown-item" href="../articles/clustering.html">CDR3 Clustering</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Visualization</h6>
    <a class="dropdown-item" href="../articles/plotting.html">Plotting</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rnabioco/djvdj/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate frequency of cell groups present in object</h1>
      <small class="dont-index">Source: <a href="https://github.com/rnabioco/djvdj/blob/HEAD/R/calc-frequency.R" class="external-link"><code>R/calc-frequency.R</code></a></small>
      <div class="d-none name"><code>calc_frequency.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate the frequency of each cell label present in the provided meta.data
column. This is useful for comparing the proportion of cells belonging to
different samples, cell types, clonotypes, isotypes, etc.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calc_frequency</span><span class="op">(</span></span>
<span>  <span class="va">input</span>,</span>
<span>  <span class="va">data_col</span>,</span>
<span>  cluster_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prefix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">data_col</span>, <span class="st">"_"</span><span class="op">)</span>,</span>
<span>  return_df <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  per_chain <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  chain <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chain_col <span class="op">=</span> <span class="va">global</span><span class="op">$</span><span class="va">chain_col</span>,</span>
<span>  sep <span class="op">=</span> <span class="va">global</span><span class="op">$</span><span class="va">sep</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>input</dt>
<dd><p>Single cell object or data.frame containing V(D)J data. If a
data.frame is provided, the cell barcodes should be stored as row names.</p></dd>


<dt>data_col</dt>
<dd><p>meta.data column containing cell labels to use for
calculating frequency. To calculate clonotype frequencies, provide the column
containing clonotype IDs, to calculate isotype frequencies provide the column
containing cell isotypes. By default the clonotype_id is used for
calculations.</p></dd>


<dt>cluster_col</dt>
<dd><p>meta.data column containing cluster IDs to use for
grouping cells when calculating clonotype abundance</p></dd>


<dt>prefix</dt>
<dd><p>Prefix to add to new columns</p></dd>


<dt>return_df</dt>
<dd><p>Return results as a data.frame. If set to <code>FALSE</code>, results
will be added to the input object.</p></dd>


<dt>per_chain</dt>
<dd><p>If <code>TRUE</code> the frequency of each per-chain value will be
calculated. If <code>FALSE</code> per-chain data will not be parsed and the values
present in <code>data_col</code> will be used as is.</p></dd>


<dt>chain</dt>
<dd><p>Chain(s) to use for calculating frequency. Set to <code>NULL</code> to
include all chains.</p></dd>


<dt>chain_col</dt>
<dd><p>meta.data column(s) containing chains for each cell</p></dd>


<dt>sep</dt>
<dd><p>Separator used for storing per-chain V(D)J data for each cell</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Single cell object or data.frame with clonotype frequencies</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot_frequency.html">plot_frequency()</a></code>, <code><a href="plot_clone_frequency.html">plot_clone_frequency()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Calculate clonotype abundance using all cells</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">calc_frequency</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">vdj_so</span>,</span></span>
<span class="r-in"><span>  data_col <span class="op">=</span> <span class="st">"clonotype_id"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">slot</span><span class="op">(</span><span class="va">res</span>, <span class="st">"meta.data"</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      orig.ident nCount_RNA nFeature_RNA RNA_snn_res.0.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1     avid_1          0            0               0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      seurat_clusters    UMAP_1    UMAP_2 clonotype_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1               0 -5.977054 -2.418108         &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      exact_subclonotype_id chains n_chains cdr3 cdr3_nt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1                    NA   &lt;NA&gt;       NA &lt;NA&gt;    &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      cdr3_length cdr3_nt_length v_gene d_gene j_gene</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1        &lt;NA&gt;           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      c_gene isotype reads umis productive full_length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1   &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      paired v_ins v_del v_mis d_ins d_del d_mis j_ins</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1     NA  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      j_del j_mis c_ins c_del c_mis all_ins all_del</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      all_mis vd_ins vd_del dj_ins dj_del v_mis_freq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1    &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;       &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      d_mis_freq j_mis_freq c_mis_freq all_mis_freq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      n_cells clonotype_id_freq clonotype_id_pct</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1      NA                NA               NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      clonotype_id_grp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1             &lt;NA&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Group cells based on meta.data column before calculating abundance</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">calc_frequency</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">vdj_sce</span>,</span></span>
<span class="r-in"><span>  data_col <span class="op">=</span> <span class="st">"clonotype_id"</span>,</span></span>
<span class="r-in"><span>  cluster_col <span class="op">=</span> <span class="st">"orig.ident"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">slot</span><span class="op">(</span><span class="va">res</span>, <span class="st">"colData"</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DataFrame with 1 row and 54 columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       orig.ident nCount_RNA nFeature_RNA RNA_snn_res.0.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      &lt;character&gt;  &lt;numeric&gt;    &lt;integer&gt;        &lt;factor&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1      avid_1          0            0               0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      seurat_clusters    UMAP_1    UMAP_2 clonotype_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             &lt;factor&gt; &lt;numeric&gt; &lt;numeric&gt;  &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1               0  -5.97705  -2.41811           NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      exact_subclonotype_id      chains  n_chains</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                  &lt;numeric&gt; &lt;character&gt; &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1                    NA          NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             cdr3     cdr3_nt cdr3_length cdr3_nt_length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      &lt;character&gt; &lt;character&gt; &lt;character&gt;    &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1          NA          NA          NA             NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           v_gene      d_gene      j_gene      c_gene</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      &lt;character&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          isotype       reads        umis  productive</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      &lt;character&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      full_length    paired       v_ins       v_del</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      &lt;character&gt; &lt;logical&gt; &lt;character&gt; &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1          NA        NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            v_mis       d_ins       d_del       d_mis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      &lt;character&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            j_ins       j_del       j_mis       c_ins</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      &lt;character&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                            c_del       c_mis     all_ins     all_del</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      &lt;character&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                          all_mis      vd_ins      vd_del      dj_ins</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      &lt;character&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           dj_del  v_mis_freq  d_mis_freq  j_mis_freq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      &lt;character&gt; &lt;character&gt; &lt;character&gt; &lt;character&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1          NA          NA          NA          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       c_mis_freq all_mis_freq   n_cells clonotype_id_freq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      &lt;character&gt;  &lt;character&gt; &lt;numeric&gt;         &lt;integer&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1          NA           NA        NA                NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      clonotype_id_pct clonotype_id_shared</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             &lt;numeric&gt;           &lt;logical&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1               NA                  NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      clonotype_id_grp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                              &lt;factor&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1               NA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add a prefix to the new columns</span></span></span>
<span class="r-in"><span><span class="co"># this is useful if multiple abundance calculations are stored in the</span></span></span>
<span class="r-in"><span><span class="co"># meta.data</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">calc_frequency</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">vdj_so</span>,</span></span>
<span class="r-in"><span>  data_col <span class="op">=</span> <span class="st">"clonotype_id"</span>,</span></span>
<span class="r-in"><span>  prefix <span class="op">=</span> <span class="st">"bcr_"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">slot</span><span class="op">(</span><span class="va">res</span>, <span class="st">"meta.data"</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      orig.ident nCount_RNA nFeature_RNA RNA_snn_res.0.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1     avid_1          0            0               0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      seurat_clusters    UMAP_1    UMAP_2 clonotype_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1               0 -5.977054 -2.418108         &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      exact_subclonotype_id chains n_chains cdr3 cdr3_nt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1                    NA   &lt;NA&gt;       NA &lt;NA&gt;    &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      cdr3_length cdr3_nt_length v_gene d_gene j_gene</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1        &lt;NA&gt;           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      c_gene isotype reads umis productive full_length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1   &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      paired v_ins v_del v_mis d_ins d_del d_mis j_ins</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1     NA  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      j_del j_mis c_ins c_del c_mis all_ins all_del</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      all_mis vd_ins vd_del dj_ins dj_del v_mis_freq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1    &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;       &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      d_mis_freq j_mis_freq c_mis_freq all_mis_freq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      n_cells bcr_freq bcr_pct bcr_grp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1      NA       NA      NA    &lt;NA&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Return a data.frame instead of adding the results to the input object</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">calc_frequency</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">vdj_sce</span>,</span></span>
<span class="r-in"><span>  data_col <span class="op">=</span> <span class="st">"clonotype_id"</span>,</span></span>
<span class="r-in"><span>  return_df <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      orig.ident nCount_RNA nFeature_RNA RNA_snn_res.0.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1     avid_1          0            0               0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      seurat_clusters    UMAP_1    UMAP_2 clonotype_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1               0 -5.977054 -2.418108         &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      exact_subclonotype_id chains n_chains cdr3 cdr3_nt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1                    NA   &lt;NA&gt;       NA &lt;NA&gt;    &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      cdr3_length cdr3_nt_length v_gene d_gene j_gene</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1        &lt;NA&gt;           &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      c_gene isotype reads umis productive full_length</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1   &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt; &lt;NA&gt;       &lt;NA&gt;        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      paired v_ins v_del v_mis d_ins d_del d_mis j_ins</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1     NA  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      j_del j_mis c_ins c_del c_mis all_ins all_del</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      all_mis vd_ins vd_del dj_ins dj_del v_mis_freq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1    &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;   &lt;NA&gt;       &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      d_mis_freq j_mis_freq c_mis_freq all_mis_freq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      n_cells clonotype_id_freq clonotype_id_pct</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1      NA                NA               NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      clonotype_id_grp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1_AAGCCGCAGCTTATCG-1             &lt;NA&gt;</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>An R package developed by the <a href="https://medschool.cuanschutz.edu/rbi" class="external-link">RNA Bioscience Initiative</a></p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

