<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create 2D feature plot — plot_features • djvdj</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Create 2D feature plot — plot_features"><meta property="og:description" content="Create a scatter plot with cells colored based on the provided feature.
This can be used to create dimensional reduction plots
(e.g. UMAP, tSNE, PCA) or to compare different cell attributes
(e.g. CD4 vs CD8 expression).
plot_vdj_feature() allows per-chain V(D)J data to be summarized
and plotted for each cell."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">djvdj</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/avid.html">V(D)J analysis</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/rnabioco/djvdj/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create 2D feature plot</h1>
    <small class="dont-index">Source: <a href="https://github.com/rnabioco/djvdj/blob/HEAD/R/plot-vdj.R" class="external-link"><code>R/plot-vdj.R</code></a></small>
    <div class="hidden name"><code>plot_features.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create a scatter plot with cells colored based on the provided feature.
This can be used to create dimensional reduction plots
(e.g. UMAP, tSNE, PCA) or to compare different cell attributes
(e.g. CD4 vs CD8 expression).</p>
<p>plot_vdj_feature() allows per-chain V(D)J data to be summarized
and plotted for each cell.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">plot_features</span><span class="op">(</span><span class="va">input</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for default</span>
<span class="fu">plot_features</span><span class="op">(</span>
  <span class="va">input</span>,
  <span class="va">feature</span>,
  x <span class="op">=</span> <span class="st">"UMAP_1"</span>,
  y <span class="op">=</span> <span class="st">"UMAP_2"</span>,
  plot_colors <span class="op">=</span> <span class="cn">NULL</span>,
  plot_lvls <span class="op">=</span> <span class="cn">NULL</span>,
  min_q <span class="op">=</span> <span class="cn">NULL</span>,
  max_q <span class="op">=</span> <span class="cn">NULL</span>,
  na_color <span class="op">=</span> <span class="st">"grey90"</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for Seurat</span>
<span class="fu">plot_features</span><span class="op">(</span>
  <span class="va">input</span>,
  <span class="va">feature</span>,
  x <span class="op">=</span> <span class="st">"UMAP_1"</span>,
  y <span class="op">=</span> <span class="st">"UMAP_2"</span>,
  data_slot <span class="op">=</span> <span class="st">"data"</span>,
  plot_colors <span class="op">=</span> <span class="cn">NULL</span>,
  plot_lvls <span class="op">=</span> <span class="cn">NULL</span>,
  min_q <span class="op">=</span> <span class="cn">NULL</span>,
  max_q <span class="op">=</span> <span class="cn">NULL</span>,
  na_color <span class="op">=</span> <span class="st">"grey90"</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">plot_vdj_feature</span><span class="op">(</span><span class="va">input</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for default</span>
<span class="fu">plot_vdj_feature</span><span class="op">(</span>
  <span class="va">input</span>,
  <span class="va">data_col</span>,
  x <span class="op">=</span> <span class="st">"UMAP_1"</span>,
  y <span class="op">=</span> <span class="st">"UMAP_2"</span>,
  summary_fn <span class="op">=</span> <span class="cn">NULL</span>,
  chain <span class="op">=</span> <span class="cn">NULL</span>,
  plot_lvls <span class="op">=</span> <span class="cn">NULL</span>,
  min_q <span class="op">=</span> <span class="cn">NULL</span>,
  max_q <span class="op">=</span> <span class="cn">NULL</span>,
  na_color <span class="op">=</span> <span class="st">"grey90"</span>,
  chain_col <span class="op">=</span> <span class="st">"chains"</span>,
  sep <span class="op">=</span> <span class="st">";"</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S3 method for Seurat</span>
<span class="fu">plot_vdj_feature</span><span class="op">(</span>
  <span class="va">input</span>,
  <span class="va">data_col</span>,
  x <span class="op">=</span> <span class="st">"UMAP_1"</span>,
  y <span class="op">=</span> <span class="st">"UMAP_2"</span>,
  data_slot <span class="op">=</span> <span class="st">"data"</span>,
  summary_fn <span class="op">=</span> <span class="cn">NULL</span>,
  chain <span class="op">=</span> <span class="cn">NULL</span>,
  plot_lvls <span class="op">=</span> <span class="cn">NULL</span>,
  min_q <span class="op">=</span> <span class="cn">NULL</span>,
  max_q <span class="op">=</span> <span class="cn">NULL</span>,
  na_color <span class="op">=</span> <span class="st">"grey90"</span>,
  chain_col <span class="op">=</span> <span class="st">"chains"</span>,
  sep <span class="op">=</span> <span class="st">";"</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>input</dt>
<dd><p>Single cell object or data.frame containing V(D)J data. If a
data.frame is provided, the cell barcodes should be stored as row names.</p></dd>
<dt>...</dt>
<dd><p>Additional arguments to pass to ggplot2, e.g. color, fill, size,
linetype, etc.</p></dd>
<dt>feature</dt>
<dd><p>Variable to use for coloring points</p></dd>
<dt>x</dt>
<dd><p>Variable to plot on x-axis</p></dd>
<dt>y</dt>
<dd><p>Variable to plot on y-axis</p></dd>
<dt>plot_colors</dt>
<dd><p>Vector of colors to use for plotting</p></dd>
<dt>plot_lvls</dt>
<dd><p>Levels to use for ordering feature</p></dd>
<dt>min_q</dt>
<dd><p>Minimum quantile cutoff for color scale.</p></dd>
<dt>max_q</dt>
<dd><p>Maximum quantile cutoff for color scale.</p></dd>
<dt>na_color</dt>
<dd><p>Color to use for missing values</p></dd>
<dt>data_slot</dt>
<dd><p>Slot in the Seurat object to pull data</p></dd>
<dt>data_col</dt>
<dd><p>meta.data column containing V(D)J data to use for coloring
cells</p></dd>
<dt>summary_fn</dt>
<dd><p>Function to use for summarizing values for each cell,
possible values can be either a function, e.g. mean, or a purrr-style
lambda, e.g. ~ mean(.x, na.rm = TRUE) where ".x" refers to the column. If
NULL, the mean will be calculated for numeric values, non-numeric columns
will be combined into a single string.</p></dd>
<dt>chain</dt>
<dd><p>Chain(s) to use for filtering data before plotting. If NULL
data will not be filtered based on chain.</p></dd>
<dt>chain_col</dt>
<dd><p>meta.data column containing chains for each cell</p></dd>
<dt>sep</dt>
<dd><p>Separator used for storing per-chain V(D)J data for each cell</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>ggplot object</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="summarize_vdj.html">summarize_vdj()</a></code> for more examples on how per-chain data can be
summarized for each cell</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># Create UMAP with cells colored based on sample name</span></span>
<span class="r-in"><span class="fu">plot_features</span><span class="op">(</span></span>
<span class="r-in">  <span class="va">tiny_so</span>,</span>
<span class="r-in">  feature <span class="op">=</span> <span class="st">"orig.ident"</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_features-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Compare UMI counts for each cell with number of genes detected</span></span>
<span class="r-in"><span class="fu">plot_features</span><span class="op">(</span></span>
<span class="r-in">  <span class="va">tiny_sce</span>,</span>
<span class="r-in">  feature <span class="op">=</span> <span class="st">"orig.ident"</span>,</span>
<span class="r-in">  x <span class="op">=</span> <span class="st">"nFeature_RNA"</span>,</span>
<span class="r-in">  y <span class="op">=</span> <span class="st">"nCount_RNA"</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_features-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plot average CDR3 length for each cell for light chains</span></span>
<span class="r-in"><span class="fu">plot_vdj_feature</span><span class="op">(</span></span>
<span class="r-in">  <span class="va">vdj_so</span>,</span>
<span class="r-in">  data_col <span class="op">=</span> <span class="st">"cdr3_length"</span>,</span>
<span class="r-in">  summary_fn <span class="op">=</span> <span class="va">mean</span>,</span>
<span class="r-in">  chain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IGK"</span>, <span class="st">"IGL"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_features-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plot median number of insertions for each cell</span></span>
<span class="r-in"><span class="fu">plot_vdj_feature</span><span class="op">(</span></span>
<span class="r-in">  <span class="va">vdj_sce</span>,</span>
<span class="r-in">  data_col <span class="op">=</span> <span class="st">"n_insertion"</span>,</span>
<span class="r-in">  summary_fn <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_features-4.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Using a lambda function to summarize values</span></span>
<span class="r-in"><span class="co"># use ".x" to refer to values in the column</span></span>
<span class="r-in"><span class="co"># this calculates the mean number of deletions for each cell and</span></span>
<span class="r-in"><span class="co"># log10-transforms the result</span></span>
<span class="r-in"><span class="fu">plot_vdj_feature</span><span class="op">(</span></span>
<span class="r-in">  <span class="va">vdj_so</span>,</span>
<span class="r-in">  data_col <span class="op">=</span> <span class="st">"n_deletion"</span>,</span>
<span class="r-in">  summary_fn <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-plt img"><img src="plot_features-5.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ryan Sheridan, <a href="https://medschool.cuanschutz.edu/rbi" class="external-link">RNA Bioscience Initiative</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

